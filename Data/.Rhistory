getwd()
# setwd("~/Desktop/Colabs/Patricia_Climbers/climbers")
setwd("G:/Meu Drive/Papers/Diversificação/climbers")
library(lcvplants)
library(beepr)
library(phangorn)
library(ape)
library(dplyr)
library(arsenal)
library(tidyverse)
library(geiger)
setwd("G:/Meu Drive/Papers/Diversificação/climbers/2_div_in_time")
# setwd("~/Desktop/Colabs/Patricia_Climbers/climbers")
setwd("G:/Meu Drive/Papers/Diversificação/climbers")
# reading the data
# setwd("G:/Meu Drive/Papers/Diversificação/climbers/Data")
climbers<-read.csv("climber_database.csv", stringsAsFactors = F)
# reading the data
setwd("G:/Meu Drive/Papers/Diversificação/climbers/Data")
# reading the data
# setwd("G:/Meu Drive/Papers/Diversificação/climbers/Data")
climbers<-read.csv("climber_database.csv", stringsAsFactors = F)
#saveRDS(h,file="LCVP_climbers.Rdata")
h<-readRDS(file="LCVP_climbers.Rdata")
#saveRDS(h,file="LCVP_climbers.Rdata")
h<-readRDS(file="LCVP_climbers.Rdata")
x<-readRDS(file="xxLCVP_climbers.Rdata")
x<-readRDS(file="xxLCVP_climbers.Rdata")
x<-readRDS(file="xxLCVP_climbers.Rdata")
accepted<-subset(h, Status=="accepted")
problems<-subset(h, Status!="accepted")
# counting genera of climbers
genera<-unique(accepted$Genus) # 689 generos, 100 a menos que o database original...
# counting species of NT climbers in every genus
sppclimbers<-as.data.frame(table(unlist(accepted$Genus)))
colnames(sppclimbers)<-c("Genus", "Nr")
# counting all species for every genus of NT climbers
list <- list()
for (i in 1:length(genera))  {
list[[i]]<-LCVP(genera[[i]], genus_tab = T)
}
beep("mario")
rm(list)
#saveRDS(sppall, file="sppall.Rdata")
sppall<-readRDS(file="sppall.Rdata")
# finding the genera in sppall but not in sppclimbers
z<-sppall$Genus %in% sppclimbers$Genus
z<-as.numeric(which(z==F))
z
sppall[z,]
length(z)
View(sppclimbers)
View(sppall)
list <- list()
for (i in 1:length(genera))  {
list[[i]]<-LCVP(genera[[i]], genus_tab = T)
}
beep("mario")
# glueing together all species for every genus of climbers and counting them
x<-do.call(rbind,list)
rm(list)
sppall<-sppall[-z,]
sppall<-sppall[order(sppall$Genus),]
rownames(sppall)<-c(1:689)
install.packages("datatable")
p<- read.delim("G:/Meu Drive/Papers/Diversificação/wcvp_v7_dec_2021.txt", sep="|", header=T)
powo<-subset(p, rank=="SPECIES") # coluna 'taxon_name' pra nomes
# filtering powo to climbing accepted species
c <- powo %>% filter(taxon_name %in% climbers$Species) # works fine
climbers_acc <- subset(c, taxonomic_status=="Accepted") # accepted names
climbers_exc <- subset(c, taxonomic_status!="Accepted") # non accepted names
# counting species per family and per genera
spp.family<-as.data.frame(table(unlist(climbers_acc$family)))
View(spp.family)
colnames(spp.family)<-c("Family", "Nr")
order(spp.family$Family)
spp.family<-spp.family[order(spp.family$Family),]
spp.family<-spp.family[order(spp.family$Nr),]
spp.family<-spp.family[-order(spp.family$Nr),]
# counting species per family and per genera
spp.family<-as.data.frame(table(unlist(climbers_acc$family)))
colnames(spp.family)<-c("Family", "Nr")
spp.family<-spp.family[order(-spp.family$Nr),]
spp.genera<-as.data.frame(table(unlist(climbers_acc$genus)))
colnames(spp.genera)<-c("Genus", "Nr")
spp.genera<-spp.genera[order(-spp.genera$Nr),]
View(spp.genera)
## LCVP ##
setwd("G:/Meu Drive/Papers/Diversificação/climbers/Data")
#saveRDS(genera75, file="genera75.Rdata")
genera75.LVCP <- readRDS("genera75.Rdata")
saveRDS(spp.family, file="G:/Meu Drive/Papers/Diversificação/climbers/Data/spp.family.POWO.Rdata")
saveRDS(spp.genera, file="G:/Meu Drive/Papers/Diversificação/climbers/Data/spp.genera.POWO.Rdata")
View(spp.genera)
View(climbers)
View(climbers)
View(powo)
## POWO ##
# preciso pegar as spp todas dps generos de climbers
sppall.POWO <- powo %>% filter(genus %in% spp.genera$Genus)
View(sppall.POWO)
sppall.POWO <- subset(sppall.POWO,taxonomic_status=="Accepted")
sppall.POWO <- as.data.frame(table(unlist(sppall.POWO$genus)))
colnames(sppall.POWO)<-c("Genus", "Nr")
sppall.POWO <- spp.genera[order(-sppall.POWO$Nr),]
sppall.POWO <- sppall.POWO[order(-sppall.POWO$Nr),]
View(sppall)
#saveRDS(sppall, file="sppall.Rdata")
sppall<-readRDS(file="sppall.Rdata")
# finding the genera in sppall but not in sppclimbers
z<-sppall$Genus %in% sppclimbers$Genus
z<-as.numeric(which(z==F))
sppall[z,] # mostra os 16 generos que estão em sppall mas não em sppclimbers
# excluding these genera from sppall
sppall<-sppall[-z,]
sppall<-sppall[order(sppall$Genus),]
rownames(sppall)<-c(1:689)
sppclimbers<-sppclimbers[order(sppclimbers$Genus),]
View(spp.genera)
spp.genera$Genus
View(x)
# finding all species per genera of climbers
sppall.POWO <- powo %>% filter(genus %in% spp.genera$Genus)
sppall.POWO <- subset(sppall.POWO,taxonomic_status=="Accepted")
sppall.POWO$genus
unlist(sppall.POWO$genus)
table(unlist(sppall.POWO$genus))
sppall.POWO <- as.data.frame(table(unlist(sppall.POWO$genus)))
colnames(sppall.POWO)<-c("Genus", "Nr")
sppall.POWO <- sppall.POWO[order(-sppall.POWO$Nr),]
# calculating the proportions
percent.POWO<-data.frame(sppall.POWO$Genus, c(spp.genera$Nr/sppall.POWO$Nr))
colnames(percent.POWO)<-c("Genus","perc_NT_spp")
percent.POWO<-percent.POWO[order(-percent.POWO$perc_NT_spp),]
View(sppall.POWO)
View(percent.POWO)
c(spp.genera$Nr/sppall.POWO$Nr)
